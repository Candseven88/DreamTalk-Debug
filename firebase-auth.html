<!-- Firebase App + Auth CDN -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<!-- 自动匿名登录脚本 -->
<script>
  // 初始化 Firebase + 匿名登录
  document.addEventListener('DOMContentLoaded', function() {
    // Firebase 配置
    const firebaseConfig = {
    apiKey: "AIzaSyD4fhwhOOFF7CBEWYnOplLiAh021905LAQ",
    authDomain: "dreamtalk-91c96.firebaseapp.com",
    projectId: "dreamtalk-91c96",
    storageBucket: "reamtalk-91c96.appspot.com",
    messagingSenderId: "1073825503044",
    appId: "1:1073825503044:web:c70d0c119795b66dab6911",
    measurementId: "G-XJZE5QM6W0"
  };

    // 初始化 Firebase
    firebase.initializeApp(firebaseConfig);
    
    // 获取 Auth 实例
    const auth = firebase.auth();
    
    // 检查用户是否已登录
    auth.onAuthStateChanged(function(user) {
      if (user) {
        // 用户已登录，保存 UID 到 localStorage
        localStorage.setItem('userId', user.uid);
        console.log('User is signed in with UID:', user.uid);
      } else {
        // 用户未登录，执行匿名登录
        auth.signInAnonymously()
          .then(() => {
            console.log('Anonymous authentication successful');
          })
          .catch((error) => {
            console.error('Anonymous authentication error:', error.code, error.message);
          });
      }
    });
  });
</script>